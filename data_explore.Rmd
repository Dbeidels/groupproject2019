---
title: "Final Project"
authors: "Daniel Beidelschies, Kai Akimoto, Tim Minot"
output: 
  html_document:
      keep_md: yes
---

```{r,echo=FALSE,message=FALSE}
library(fivethirtyeight)
library(tidyverse)
library(broom)
library(moderndive)
library(NHANES)
view(NHANES)
```


The draft should include the following:

## Research Question 

+ For our project we will be utilizing the NHANES data set as well as the health_coverage data set. The NHANES data set contains verious health related information that help to shed light on the quality of life that an individual has. We aim to use this data to investigate how certain socioeconomic factors play role in quality of health.

## Graphs 

```{r, echo=FALSE,warning=FALSE}
NHANES %>% 
  ggplot(aes(x=Age,y=BPSysAve, color=Diabetes))+
  geom_jitter()
```

+ This graph shows the relationship between Systolic Blood pressure of older individuals with Diabetes. As you can see, as individuals get older, they are more likely to have incidence of diabetes as well as a higher blood pressure.

```{r,echo=FALSE,warning=FALSE}
NHANES %>% 
  ggplot(aes(x=Diabetes,y=Poverty,color=Race3))+
  geom_boxplot()
```

+ This shows how people of different races are affected by diabetes based on their level of poverty. The lower the y value, the more poverty that the race has on average. 

```{r,echo=FALSE,warning=FALSE}
NHANES %>% 
  ggplot(aes(x=Poverty,y=BPSysAve, color=PhysActive))+
  geom_jitter()
```
```{r,echo=FALSE,warning=FALSE}
NHANES %>% 
  ggplot(aes(x=Race3, y=BPSysAve,color=Smoke100))+
  geom_boxplot()
```
```{r,echo=FALSE,warning=FALSE}
NHANES %>% 
  ggplot(aes(x=Race3,y=Poverty,color=Diabetes))+
  geom_boxplot()
```
## Models
```{r,echo=FALSE}
lm_health <- lm(BPSysAve~Age+Race3, data=NHANES)

tidy(lm_health)
```

+ This partial interaction model helps to show how Race and Age interact to affect Systolic Blood Pressure because it helps to shed light on how certain races are more likely to experience an increase in blood pressure (which associated with poorer health). 

+ The intercept represents Asian individuals at the age of 0. The Age coefficient represents the average unit of increase for bloodpressure as individuals get older. As you can see, there is an extremely high p-value, supporting the strong relationship between age and bloodpressure increase. 

+ Race3Hispanic, Race3Mexican, Race3White, coefficients represent the increase of blood pressure for individuals that are Hispanic, Mexican, or White respectively. These coefficients are not dependent on Age and these estimates are purely the average unit of increase for these races. As you can see, the p-value for individuals of these races are very high, meaning that there the liklihood of the Blood Pressure Increase for these indviduals is not likley to be due to their race. 

+ Race3Black coefficient represents the avaerage unit of increase for blood pressure of inidividuals that are Black. As you can see that black individuals have a significantly higher increase of blood pressure, "+5.51", than other races. Furthermore, the p-value of this coefficient is significantly lower, outlining a very strong relationship between an indidual being black and their systolic blood pressure increase. 

```{r,echo=FALSE}
lm_Poverty <- lm(BPSysAve~Age*Poverty, data=NHANES)

tidy(lm_Poverty)
```
+ This full interaction model shows how both Age and Poverty interact with each other to affect systolic blood pressure. The data shows how people of higher economic status will have a lower blood pressure on average than those of a lower economic status. 
+ Intercept coefficient represents the average systolic blood pressure when both the age and poverty level is 0.
+ As we've established in previous models and graphs, Age and systolic blood pressure increase are very strongly related. As the p value for the age coefficient is quite miniscule showing a strong relationship
+ The poverty coefficient is the average unit increase depending on the categorical numerical value of poverty. In this integer-based numerical category, 1 is indicative of most poverty stricken and 5 is least poverty stricken. 
+ The Age:Poverty coefficient is the average unit of change of Systolic blood pressure for aging individuals depending on their poverty level. Since the estimate is negative, we can determine that as individuals get older, the less poverty stricken they are (i.e. 5), the more their blood pressure will decrease.


```{r,echo=FALSE}
lm.phycical <-lm(BPSysAve~PhysActive,data=NHANES)

tidy(lm.phycical)
```

```{r,echo=FALSE}
lm.pov.act <- lm(BPSysAve~PhysActive+Poverty,data = NHANES)

tidy(lm.pov.act)
```

```{r,echo=FALSE}
lm.race.act <- lm(BPSysAve~PhysActive+Race3,data = NHANES)

tidy(lm.race.act)
```






```{r,echo=FALSE}
lm.race.pov  <- lm(Poverty~Race3+Diabetes,data=NHANES)

tidy(lm.race.pov)
```
+ Intercept is for Asians without diabetes. Indivieuals with diabetes in general have an average increase impoverishment (negative estimate) When you factor in race, Black, Hispanics, Mexicans all have an increase in impoverishment (negative estimate), while Whites tend to have a decrease in impoverishment. 
```{r,echo=FALSE}
lm.diabetes <- lm(BPSysAve~Diabetes+PhysActive,data=NHANES)

tidy(lm.diabetes)
```

```{r,echo=FALSE}
lm.diabetes.active <- lm(BPSysAve~Diabetes*PhysActive,data=NHANES)

tidy(lm.diabetes.active)
```

## Inferences
```{r,echo=FALSE}
set.seed(1129) 

bootstrap_BP <- 
  rep_sample_n(NHANES,
               size = nrow(NHANES),
               reps = 100,
               replace = TRUE) %>% 
  group_by(replicate) %>%      
  do(lm(BPSysAve ~ Age*Poverty, data=.) %>% tidy()) %>% 
  filter(term == "(Intercept)") %>% 
  ungroup()
```
+ The number below represents the confidence interval for the intercept of BPSysAve when Age and Poverty are fully interacting.
```{r, echo=FALSE}
SE <- sd(bootstrap_BP  %>% pull(estimate))
SE
bootstrap_BP %>% 
  ungroup() %>% 
  summarize(SE = sd(estimate))
```
```{r,echo=FALSE}
estimated_coeff <- tidy(lm_Poverty) %>% 
  filter(term == "(Intercept)") %>% 
  pull(estimate)

bootstrap_BP %>% 
  select(replicate, estimate) %>% 
  ungroup() %>% 
  summarize(lower = estimated_coeff - 2*sd(estimate),
            upper = estimated_coeff + 2*sd(estimate))

c(estimated_coeff - 2*SE, estimated_coeff + 2*SE)
```
+ Based on the analysis, our hypothesis is that Age affects health quality. We infer that socioeconomic factors (specifically race, poverty, *Physical Activity)  affect health qualtity. Based on our preliminary investigation, we can infer that the health of certain races are more impacted by poverty than others. 


```{r,echo=FALSE,warning=FALSE}
NHANES %>% 
  count(Race3) 
```
